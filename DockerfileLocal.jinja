FROM tiangolo/uvicorn-gunicorn-fastapi:python3.11

WORKDIR /app

ENV PYTHONUNBUFFERED=1
ENV PYTHONIOENCODING=UTF-8

RUN pip3 install --upgrade pip==24.0
RUN pip3 install uv

COPY pyproject.toml .
RUN uv pip install -e ".[dev]" --system

COPY app/ ./app
COPY alembic.ini .

EXPOSE 8000

CMD ["uvicorn", "app.app:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]